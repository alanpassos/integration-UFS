CREATE TABLE TB_VENDAS_S2_2013(
		CD_PRODUTO INT NOT NULL,
		CD_FUNCIONARIO INT NOT NULL,
		DT_VENDA DATETIME CHECK(DT_VENDA >= '20130701' AND
									DT_VENDA < '20140101'),
		VL_VENDA NUMERIC(10,2)	
		CONSTRAINT TB_VENDAS_S2_2013_PK
		PRIMARY KEY (CD_PRODUTO, CD_FUNCIONARIO, DT_VENDA)
	)
;	

CREATE TABLE TB_VENDAS_S1_2014(
		CD_PRODUTO INT NOT NULL,
		CD_FUNCIONARIO INT NOT NULL,
		DT_VENDA DATETIME CHECK(DT_VENDA >= '20140101' AND
									DT_VENDA < '20140701'),
		VL_VENDA NUMERIC(10,2)	
		CONSTRAINT TB_VENDAS_S1_2014_PK
		PRIMARY KEY (CD_PRODUTO, CD_FUNCIONARIO, DT_VENDA)
	)
;	


CREATE TABLE TB_VENDAS_S2_2014(
		CD_PRODUTO INT NOT NULL,
		CD_FUNCIONARIO INT NOT NULL,
		DT_VENDA DATETIME CHECK(DT_VENDA >= '20140701' AND
									DT_VENDA < '20150101'),
		VL_VENDA NUMERIC(10,2)	
		CONSTRAINT TB_VENDAS_S2_2014_PK
		PRIMARY KEY (CD_PRODUTO, CD_FUNCIONARIO, DT_VENDA)
	)
;	

CREATE VIEW VW_VENDAS AS
SELECT * FROM TB_VENDAS_S2_2013
UNION ALL
SELECT * FROM TB_VENDAS_S1_2014
UNION ALL
SELECT * FROM TB_VENDAS_S2_2014
;

INSERT INTO VW_VENDAS ("CD_PRODUTO", "CD_FUNCIONARIO", "DT_VENDA", "VL_VENDA") VALUES (2, 1, '13/07/2014 21:17:35', 34);