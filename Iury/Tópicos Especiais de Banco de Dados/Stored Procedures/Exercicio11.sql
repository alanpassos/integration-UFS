INSERT INTO TB_USUARIO_EXE11 
VALUES (001, 'JOSÉ', 2512365),
		(002, 'MARIA', 1253148),
		(003, 'CARLA', 85236412),
		(004, 'CECILIA', 5421365)

INSERT INTO TB_LANCAMENTOS_EXE11 
VALUES (03, 2010, 001, 'R', 'DESCRICAO QUALQUER', 5600.0),
		(05, 2012, 001, 'D', 'DESCRICAO QUALQUER 2', 1450.0),
		(04, 2011, 002, 'D', 'DESCRICAO QUALQUER 3', 350.0),
		(09, 2011, 002, 'R', 'DESCRICAO QUALQUER 4', 1900.0),
		(08, 2013, 003, 'R', 'DESCRICAO QUALQUER 5', 8450.0),
		(12, 2014, 004, 'D', 'DESCRICAO QUALQUER 6', 150.0)



CREATE PROCEDURE SP_OBTEM_RESUMO_EXE11 (@CODIGO_USUARIO INT, @MES INT, @ANO INT, 
					@DESPESAS NUMERIC(10,2) OUTPUT, @RECEITAS NUMERIC (10,2) OUTPUT) AS

SELECT SUM(L.VALOR) AS VALOR FROM TB_LANCAMENTOS_EXE11 L
WHERE (@CODIGO_USUARIO = L.CD_USUARIO AND @MES = L.MES AND @ANO = L.ANO AND L.TP_LANCAMENTO = 'R')


SELECT SUM(L.VALOR) AS 'VALOR_DESPESA' FROM TB_LANCAMENTOS_EXE11 L
WHERE (@CODIGO_USUARIO = L.CD_USUARIO AND @MES = L.MES AND @ANO = L.ANO AND L.TP_LANCAMENTO = 'D')
SET @DESPESAS = L.VALOR






SELECT C.CD_USUARIO, SUM(L.VALOR) FROM TB_USUARIO_EXE11 C
INNER JOIN TB_LANCAMENTOS_EXE11 L ON (C.CD_USUARIO = L.CD_USUARIO AND L.TP_LANCAMENTO = 'R')
GROUP BY C.CD_USUARIO
ORDER BY SUM(L.VALOR) DESC

